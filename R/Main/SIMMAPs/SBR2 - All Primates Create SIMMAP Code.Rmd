---
title: "Grabowski et al. - SBR2 - Create SIMMAPs"
output: html_notebook
editor_options: 
  chunk_output_type: console
---
All Primates Analysis

Formerly: "SBR2 - BDS ms All Primates Make SIMMAPs Code - 062522 v1"

Run: SIMMAPS 062522 v1
	Testing revised data from R2 but running original fitMk program, not parallel
	Gorilla g in strict classification is folivore
	Predictors:
		Fol.Non.Fol.Strict
		Fol.Non.Fol.Per
		Frug.Non.Frug.Per
		Social.System.DRclass
		Social.System.DGT
		Mating.System
		Activity.Period.DN
		GSC >50

```{r}

rm(list=ls())

closeAllConnections()

#devtools::install_github("kopperud/slouch")
library(slouch)

#devtools::install_github("liamrevell/phytools")
library(treeplyr)
library(phytools)
library(optimParallel)

options(scipen=999)

#Load programs written for R1
source("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/SB Revision 1/Programs/make.slouch.simmap.table.v1.R")

source("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/SB Revision 1/Programs/make.slouch.simmap.AIC.table.R1.v1.R")

source("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/SB Revision 1/Programs/make.regression.table.R1.R")

source("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/SB Revision 1/Programs/make.slouch.table.R1.v1.R")

```

Read in all data, including data on brain and body size with measurement error from Grabowski et al. (2016)

```{r}
#SB Revision 1 Tree
phylo.tree<-read.tree("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/SB Revision 1/Tree/SB_Rv1_10K.tre")

#After renaming family to Callitrichidae - only change
brbo.data<-read.csv("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/New Data/ME Data/BrBo_means_predME_10192020_Callitri_tarsiers_step.csv")

diet.data<-read.csv("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/New Data/My Diet Data/Primate_Diet_Breakdown_062522.csv")

avg_GS.data<-read.csv("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/New Data/New Group Size Data/ActPeriod GroupSize Data 050822.csv")

SS.data<-read.csv("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/New Data/New SS Data/Sociality Dataset 061022.csv")


```

Drop tip for Callimico_goeldii to match R1 submission
```{r}
which(phylo.tree$tip.label=="Callimico_goeldii")
length(phylo.tree$tip.label)
phylo.tree<-drop.tip(phylo.tree,tip="Callimico_goeldii")
length(phylo.tree$tip.label)

```


Rescale to unit length
```{r}
l.tree<-max(branching.times(phylo.tree))
phylo.tree$edge.length<-phylo.tree$edge.length/l.tree ## rescale tree to height 1
max(branching.times(phylo.tree))

```


Get tree length
```{r}
phylo.tree <- multi2di(phylo.tree, random=FALSE)
phylo.tree$edge.length[phylo.tree$edge.length==0] <- .Machine$double.eps

#Reorder tree "postorder" to match bayou
phylo.tree<-reorder(phylo.tree,order = "postorder")
max(branching.times(phylo.tree))
```


Add on measurement error columns for Brain and Body Size
```{r}
#Brain/Body/Diet Data
brbo.data$N.species

brbo.data<-mutate(brbo.data,me.ECV.species=brbo.data$predict.sp.ln_ECV/brbo.data$N.species)
brbo.data<-mutate(brbo.data,me.BoM.species=brbo.data$predict.sp.ln_Body.mass/brbo.data$N.body.mass.species)

brbo.data<-mutate(brbo.data,me.ECV.females=brbo.data$predict.F.ln_ECV/brbo.data$N.female)
brbo.data<-mutate(brbo.data,me.BoM.females=brbo.data$predict.F.ln_Body.mass/brbo.data$N.body.mass.female)

brbo.data<-mutate(brbo.data,me.ECV.males=brbo.data$predict.M.ln_ECV/brbo.data$N.male)
brbo.data<-mutate(brbo.data,me.BoM.males=brbo.data$predict.M.ln_Body.mass/brbo.data$N.body.mass.male)
```

Split into Haplorhinnes vs. Strepsirrhines
```{r}
#brbo.data<-filter(brbo.data,Suborder=="Haplorrhini")
#brbo.data<-filter(brbo.data,Suborder=="Strepsirrhini")
#brbo.data<-filter(brbo.data,Parvorder=="Catarrhini")
#brbo.data<-filter(brbo.data,Parvorder=="Platyrrhini")

```

Max vy for body mass - add in upper range for vy
```{r}
#3* Variance of logged response is good upper range for vy says Kjetil, but too much in this case
max.vy<-var(log(brbo.data$Body.mass.species.mean),na.rm=TRUE)
max.hl<-max(branching.times(phylo.tree))
```

Diet Data, independently
```{r}
#Frug/Non Frug, Fol/Non Fol Diet Category Data
BrBo.diet.data<-merge(brbo.data,diet.data,by="Genus_Species")
dim(BrBo.diet.data)

BrBo.diet.trdata <- make.treedata(phylo.tree, BrBo.diet.data,name_column="Genus_Species")
#BrBo.diet.trdata<-filter(BrBo.diet.trdata,!is.na(ECV.species.mean)&!is.na(Body.mass.species.mean)&!is.na(Frug.Non.Frug.Per))

BrBo.diet.trdata<-filter(BrBo.diet.trdata,!is.na(ECV.species.mean)&!is.na(Body.mass.species.mean))

dim(BrBo.diet.trdata$dat)

BrBo.diet.trdata<-filter(BrBo.diet.trdata, N.male>=1 & N.body.mass.male>=1 & N.female>=1 & N.body.mass.female>=1 & N.species>1 & N.body.mass.species>1)

dim(BrBo.diet.trdata$dat)

```

Setup for Merged Data
Merged Brain/Body + Diet % + DC + GS + SS + AP, n=XX
```{r}
BrBo.Diet.GS.data<-merge(BrBo.diet.data,avg_GS.data,by="Genus_Species")
BrBo.Diet.GS.SS.data<-merge(BrBo.Diet.GS.data,SS.data,by="Genus_Species")

dim(BrBo.Diet.GS.SS.data)

BrBo.Diet.DC.GS.SS.AP.trdata <- make.treedata(phylo.tree, BrBo.Diet.GS.SS.data,name_column="Genus_Species")

#BrBo.Diet.DC.GS.SS.AP.trdata<-filter(BrBo.Diet.DC.GS.SS.AP.trdata,!is.na(ECV.species.mean)&!is.na(Body.mass.species.mean)&!is.na(Combo.AGS)&!is.na(Social.System)&!is.na(Frug.Non.Frug.Per)&!is.na(Activity.Period.DN))

BrBo.Diet.DC.GS.SS.AP.trdata<-filter(BrBo.Diet.DC.GS.SS.AP.trdata,!is.na(ECV.species.mean)&!is.na(Body.mass.species.mean)&!is.na(Combo.AGS)&!is.na(Social.System.DRclass)&!is.na(Frug.Non.Frug.Per))


BrBo.Diet.DC.GS.SS.AP.trdata<-filter(BrBo.Diet.DC.GS.SS.AP.trdata, N.male>=1 & N.body.mass.male>=1 & N.female>=1 & N.body.mass.female>=1 & N.species>1 & N.body.mass.species>1)

library(plyr)
BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per<-revalue(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,c("Fol"="Folivorous","Non.Fol"="Non"))

BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per<-revalue(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per,c("Frug"="Frugivorous","Non.Frug"="Non"))

dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)

```


Break average group size continuous variable into categories
```{r}
#################
library(ape)

#Group size into 
gs.cat<-cut(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS,
    #breaks = c(0,5, 10, 25, Inf), 
    #labels = c("1-5","6-10","11-25",">25"), 
    breaks = c(0,5, 10, 25, 50,Inf), 
    labels = c("1-5","6-10","11-25","26-50",">50"), 
    right = FALSE)

BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size<-gs.cat
```

Simmap Setup
```{r}
sim.num<-25 #25
loops.num<-2 #2
```


Now use SIMMAP to reconstruct social system, group size, for painting on trees  
```{r}
#Setup dataset for info on model fits
saved.discrete.models<-data.frame("Model"=NA,"AIC ER"=NA,"AIC SYM"=NA,"AIC ARD"=NA)
```

# Make SIMMAPs

Social System Group Type Models
Strict Folivore Definition
```{r}
#cl = makeCluster(parallel::detectCores()-2) 
#cl<-parallel::detectCores()-2 #Cl for fitMk function
num.cores=parallel::detectCores()-2 #For mclapply function

#########################################
#Fol.Non.Fol.Strict Diet Categories + SSGT + AP
#reconstruction.FoDCS.ssgt <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDCS.ssgt.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDCS.ssgt.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS.ssgt<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS.ssgt,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.ssgt.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
#system.time(
#fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
#)

#system.time(
#fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD"))


saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + SSGT + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.ssgt.ap<-trees


######################################
#Fol.Non.Fol.Strict Diet Categories + SSGT
#reconstruction.FoDCS.ssgt <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDCS.ssgt <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT))
names(reconstruction.FoDCS.ssgt)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS.ssgt<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS.ssgt,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.ssgt

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + SSGT",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.ssgt<-trees

```

Original Folivore Definition
```{r}
#source("https://raw.githubusercontent.com/liamrevell/phytools/master/R/fitMk.R")

#########################################
#Frugivore Diet Categories + Social System GT + AP
#reconstruction.FrDC.ssgt <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC.ssgt.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FrDC.ssgt.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC.ssgt<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC.ssgt,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.ssgt.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")

#fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
#fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
#fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")


saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + SSGT + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.ssgt.ap<-trees

#########################################
#Frugivore Diet Categories + Social System GT
#reconstruction.FrDC.ssgt <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC.ssgt <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT))
names(reconstruction.FrDC.ssgt)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC.ssgt<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC.ssgt,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.ssgt

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + SSGT",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.ssgt<-trees


#########################################
#Fol.Non.Fol.Per Diet Categories + SSGT + AP
#reconstruction.FoDC.ssgt <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDC.ssgt.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDC.ssgt.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC.ssgt<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC.ssgt,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.ssgt.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + SSGT + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.ssgt.ap<-trees


######################################
#Fol.Non.Fol.Per Diet Categories + SSGT
#reconstruction.FoDC.ssgt <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDC.ssgt <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT))
names(reconstruction.FoDC.ssgt)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC.ssgt<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC.ssgt,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.ssgt

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + SSGT",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.ssgt<-trees

########################
#Social System GT + AP
#reconstruction.ssgt <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.ssgt.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.ssgt.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.ssgt<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.ssgt,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.ssgt.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("SSGT + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.ssgt.ap<-trees

########################
#Social System GT
#reconstruction.ssgt <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.ssgt <- as.vector(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)
names(reconstruction.ssgt)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.ssgt<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.ssgt,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.ssgt

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("SSGT",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.ssgt<-trees


```

```{r}
save.image("WS from SIMMAP - SS.DGT - All Primates - Scaled 062522.RData")

```

Original DeCasien Social System and Mating System Assignments but with reclassified social systems
Strict Folivore Definition
```{r}
##########################
#Fol.Non.Fol.Strict Diet Categories + Group Size Categories + AP
#reconstruction.FoDCS.gsc <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDCS.gsc.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDCS.gsc.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS.gsc<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS.gsc,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.gsc.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + GSC + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.gsc.ap<-trees

##########################
#Fol.Non.Fol.Strict Diet Categories + Group Size Categories
#reconstruction.FoDCS.gsc <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDCS.gsc <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size))
names(reconstruction.FoDCS.gsc)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS.gsc<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS.gsc,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.gsc

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + GSC",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.gsc<-trees

#########################################
#Fol.Non.Fol.Strict Diet Categories + SS + AP
#reconstruction.FoDCS.ss <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDCS.ss.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDCS.ss.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS.ss<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS.ss,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.ss.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + SS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.ss.ap<-trees

###################
#Fol.Non.Fol.Strict Diet Categories + SS
#reconstruction.FoDCS.ss <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDCS.ss <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass))
names(reconstruction.FoDCS.ss)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS.ss<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS.ss,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.ss

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + SS",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.ss<-trees

########################
#Folivore Diet Categories + Mating System + AP
#reconstruction.FoDCS.ms <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")


reconstruction.FoDCS.ms.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDCS.ms.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.ms.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + MS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))

test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.ms.ap<-trees

########################
#Folivore Diet Categories + Mating System
#reconstruction.FoDCS.ms <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")


reconstruction.FoDCS.ms <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System))
names(reconstruction.FoDCS.ms)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.ms

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + MS",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))

test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.ms<-trees


########################
#Fol.Non.Fol.Strict Diet Categories + AP
#reconstruction.FoDCS <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDCS.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDCS.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))

test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]


fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS.ap<-trees

########################
#Fol.Non.Fol.Strict Diet Categories
#reconstruction.FoDCS <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDCS <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict))
names(reconstruction.FoDCS)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDCS<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDCS,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDCS

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDCS",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))

test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]


fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDCS<-trees

```



```{r}
##########################
#Frugivore Diet Categories + Group Size Categories + AP
#reconstruction.FrDC.gsc <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC.gsc.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FrDC.gsc.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC.gsc<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC.gsc,model="ER",Q="empirical",nsim=sim.num)
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.gsc.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + GSC+ AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.gsc.ap<-trees



##########################
#Frugivore Diet Categories + Group Size Categories
#reconstruction.FrDC.gsc <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC.gsc <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size))
names(reconstruction.FrDC.gsc)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC.gsc<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC.gsc,model="ER",Q="empirical",nsim=sim.num)
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.gsc

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + GSC",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.gsc<-trees




#########################################
#Frugivore Diet Categories + Social System + AP
#reconstruction.FrDC.ss <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC.ss.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FrDC.ss.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC.ss<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC.ss,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.ss.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + SS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.ss.ap<-trees

#########################################
#Frugivore Diet Categories + Social System
#reconstruction.FrDC.ss <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC.ss <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass))
names(reconstruction.FrDC.ss)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC.ss<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC.ss,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.ss

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + SS",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.ss<-trees

#############################################
#Frugivore Diet Categories + Mating System + AP
#reconstruction.FrDC.ms <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC.ms.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FrDC.ms.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.ms.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + MS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.ms.ap<-trees

#############################################
#Frugivore Diet Categories + Mating System
#reconstruction.FrDC.ms <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC.ms <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System))
names(reconstruction.FrDC.ms)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.ms

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + MS",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.ms<-trees


##########################
#Fol.Non.Fol.Per Diet Categories + Group Size Categories + AP
#reconstruction.FoDC.gsc <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDC.gsc.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDC.gsc.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC.gsc<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC.gsc,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.gsc.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + GSC + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.gsc.ap<-trees

##########################
#Fol.Non.Fol.Per Diet Categories + Group Size Categories
#reconstruction.FoDC.gsc <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDC.gsc <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size))
names(reconstruction.FoDC.gsc)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC.gsc<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC.gsc,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.gsc

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + GSC",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.gsc<-trees

#########################################
#Fol.Non.Fol.Per Diet Categories + SS + AP
#reconstruction.FoDC.ss <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDC.ss.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDC.ss.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC.ss<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC.ss,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.ss.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + SS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.ss.ap<-trees

###################
#Fol.Non.Fol.Per Diet Categories + SS
#reconstruction.FoDC.ss <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDC.ss <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass))
names(reconstruction.FoDC.ss)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC.ss<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC.ss,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.ss

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + SS",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.ss<-trees

########################
#Folivore Diet Categories + Mating System + AP
#reconstruction.FoDC.ms <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")


reconstruction.FoDC.ms.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDC.ms.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.ms.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + MS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))

test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.ms.ap<-trees

########################
#Folivore Diet Categories Percent + Mating System
#reconstruction.FoDC.ms <- ace(as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")


reconstruction.FoDC.ms <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System))
names(reconstruction.FoDC.ms)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.ms

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + MS",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))

test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.ms<-trees


########################
#Fol.Non.Fol.Per Diet Categories + AP
#reconstruction.FoDC <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDC.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FoDC.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FoDC + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))

test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]


fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC.ap<-trees

########################
#Fol.Non.Fol.Per Diet Categories
#reconstruction.FoDC <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FoDC <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per))
names(reconstruction.FoDC)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FoDC<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FoDC,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FoDC

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD") #Slightly modified code


saved.discrete.models<-rbind(saved.discrete.models,c("FoDC",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))

test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]


fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states

trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FoDC<-trees


########################
#Frugivore Diet Categories + AP
#reconstruction.FrDC <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")
reconstruction.FrDC.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.FrDC.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC.ap<-trees

########################
#Frugivore Diet Categories
#reconstruction.FrDC <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.FrDC <- as.vector(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per)
names(reconstruction.FrDC)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.FrDC<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.FrDC,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.FrDC

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("FrDC",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.FrDC<-trees

########################
#Group Size Categories + AP
#reconstruction.gsc <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.gsc.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))

names(reconstruction.gsc.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.gsc<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.gsc,model="ER",Q="empirical",nsim=sim.num)  
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.gsc.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("GSC + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.gsc.ap<-trees
 

########################
#Group Size Categories
#reconstruction.gsc <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.gsc <- as.vector(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)
names(reconstruction.gsc)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.gsc<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.gsc,model="ER",Q="empirical",nsim=sim.num)  
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.gsc

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("GSC",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.gsc<-trees
 

########################
#Social System + AP
#reconstruction.ss <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.ss.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.ss.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.ss<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.ss,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.ss.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("SS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.ss.ap<-trees

########################
#Social System
#reconstruction.ss <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.ss <- as.vector(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)
names(reconstruction.ss)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.ss<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.ss,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.ss

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("SS",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.ss<-trees


########################
#Mating System + AP
#reconstruction.ms <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")
reconstruction.ms.ap <- as.vector(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN))
names(reconstruction.ms.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.ms.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("MS + AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.ms.ap<-trees

########################
#Mating System
#reconstruction.ms <- ace(as.factor(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System), BrBo.Diet.DC.GS.SS.AP.trdata$phy, type = "d")

reconstruction.ms <- as.vector(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)
names(reconstruction.ms)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.ms

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("Mating System",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.ms<-trees

####Activity Pattern
reconstruction.ap <- as.vector(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)
names(reconstruction.ap)<-BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label
#reconstruction.ms<-make.simmap(BrBo.Diet.DC.GS.SS.AP.trdata$phy,reconstruction.ms,model="ER",Q="empirical",nsim=sim.num)   
tree<-BrBo.Diet.DC.GS.SS.AP.trdata$phy
x<-reconstruction.ap

## fit model so we don't have to repeatedly recompute Q
fit.ER<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ER")
fit.SYM<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="SYM")
fit.ARD<-fitMk(BrBo.Diet.DC.GS.SS.AP.trdata$phy,x,model="ARD")
saved.discrete.models<-rbind(saved.discrete.models,c("AP",AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD)))
test<-c(AIC(fit.ER),AIC(fit.SYM),AIC(fit.ARD))
num.min.AIC<-match(min(test),test)
fit<-list(fit.ER,fit.SYM,fit.ARD)[[num.min.AIC]]

fittedQ<-matrix(NA,length(fit$states),length(fit$states))
fittedQ[]<-c(0,fit$rates)[fit$index.matrix+1]
diag(fittedQ)<-0
diag(fittedQ)<--rowSums(fittedQ)
colnames(fittedQ)<-rownames(fittedQ)<-fit$states
trees<-mclapply(1:loops.num,function(n,tree,x,fixedQ) make.simmap(tree,x,Q=fixedQ,nsim=sim.num),
	tree=tree,x=x,fixedQ=fittedQ,mc.cores=num.cores)
trees<-do.call(c,trees) ## combine trees
if(!("multiSimmap"%in%class(trees))) class(trees)<-c("multiSimmap",class(trees))
reconstruction.ap<-trees


```

```{r}
saved.discrete.models<-saved.discrete.models[-1,]
```

```{r}
save.image("WS SIMMAP Only - All Primates - 062522.RData")
```


Social System Group Types
Parallel Version
Strict Folivore Models First

Folivore Non-Folivore Diet Categories
```{r}
#Folivore Diet Categories + Group Size Continuous + Social System GT + AP
ECV.FoDCS.GS.SSGT.AP.BoM.OURDF<-mclapply(reconstruction.FoDCS.ssgt.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.SSGT.AP.BoM.OURDF)


ECV.FoDCS.GS.SSGT.AP.BoM.BM<-mclapply(reconstruction.FoDCS.ssgt.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.SSGT.AP.BoM.BM)



```

Folivore Non-Folivore Diet Categories
```{r}
#Folivore Diet Categories + Group Size Continuous + Social System GT
ECV.FoDCS.GS.SSGT.BoM.OURDF<-mclapply(reconstruction.FoDCS.ssgt,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.SSGT.BoM.OURDF)


ECV.FoDCS.GS.SSGT.BoM.BM<-mclapply(reconstruction.FoDCS.ssgt,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.SSGT.BoM.BM)



```



```{r}

######################
#Folivore Diet Categories + Social System GT + AP
ECV.FoDCS.SSGT.AP.BoM.OUDF<-mclapply(reconstruction.FoDCS.ssgt.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.SSGT.AP.BoM.OUDF)

ECV.FoDCS.SSGT.AP.BoM.BM<-mclapply(reconstruction.FoDCS.ssgt.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.SSGT.AP.BoM.BM)



```



```{r}

######################
#Folivore Diet Categories + Social System GT
ECV.FoDCS.SSGT.BoM.OUDF<-mclapply(reconstruction.FoDCS.ssgt,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.SSGT.BoM.OUDF)

ECV.FoDCS.SSGT.BoM.BM<-mclapply(reconstruction.FoDCS.ssgt,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.SSGT.BoM.BM)




```

```{r}
######################
#Folivore Diet Categories Strict + Group Size Categories + AP
ECV.FoDCS.GSC.AP.BoM.OUDF<-mclapply(reconstruction.FoDCS.gsc.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GSC.AP.BoM.OUDF)

ECV.FoDCS.GSC.AP.BoM.BM<-mclapply(reconstruction.FoDCS.gsc.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GSC.AP.BoM.BM)



```

###################################

## Original DeCasien Sociality Categories

Diet Categories + ...
###########################

Folivore Non-Folivore Diet Categories
```{r}
#Folivore Diet Categories + Group Size Continuous + Social System + AP
ECV.FoDCS.GS.SS.AP.BoM.OURDF<-mclapply(reconstruction.FoDCS.ss.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.SS.AP.BoM.OURDF)


ECV.FoDCS.GS.SS.AP.BoM.BM<-mclapply(reconstruction.FoDCS.ss.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.SS.AP.BoM.BM)

######################
#Folivore Diet Categories + Group Size Continuous + Mating System + AP

ECV.FoDCS.GS.MS.AP.BoM.OURDF<-mclapply(reconstruction.FoDCS.ms.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                                        fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict, BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.MS.AP.BoM.OURDF)


ECV.FoDCS.GS.MS.AP.BoM.BM<-mclapply(reconstruction.FoDCS.ms.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                                                          random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
             
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict, BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.MS.AP.BoM.BM)

```

Folivore Non-Folivore Diet Categories
```{r}
#Folivore Diet Categories + Group Size Continuous + Social System
ECV.FoDCS.GS.SS.BoM.OURDF<-mclapply(reconstruction.FoDCS.ss,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.SS.BoM.OURDF)


ECV.FoDCS.GS.SS.BoM.BM<-mclapply(reconstruction.FoDCS.ss,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.SS.BoM.BM)

######################
#Folivore Diet Categories + Group Size Continuous + Mating System

ECV.FoDCS.GS.MS.BoM.OURDF<-mclapply(reconstruction.FoDCS.ms,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.MS.BoM.OURDF)


ECV.FoDCS.GS.MS.BoM.BM<-mclapply(reconstruction.FoDCS.ms,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.MS.BoM.BM)

```


```{r}
######################
#Folivore Diet Categories + Group Size + AP
ECV.FoDCS.GS.AP.BoM.OURDF<-mclapply(reconstruction.FoDCS.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          

                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 0.1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.AP.BoM.OURDF)



ECV.FoDCS.GS.AP.BoM.BM<-mclapply(reconstruction.FoDCS.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.AP.BoM.BM)

###########
######################
#Folivore Diet Categories + Social System + AP
ECV.FoDCS.SS.AP.BoM.OUDF<-mclapply(reconstruction.FoDCS.ss.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.SS.AP.BoM.OUDF)

ECV.FoDCS.SS.AP.BoM.BM<-mclapply(reconstruction.FoDCS.ss.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.SS.AP.BoM.BM)

######################
#Folivore Diet Categories + Mating System + AP
ECV.FoDCS.MS.AP.BoM.OUDF<-mclapply(reconstruction.FoDCS.ms.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.MS.AP.BoM.OUDF)

ECV.FoDCS.MS.AP.BoM.BM<-mclapply(reconstruction.FoDCS.ms.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.MS.AP.BoM.BM)


```


```{r}
######################
#Folivore Diet Categories + Group Size
ECV.FoDCS.GS.BoM.OURDF<-mclapply(reconstruction.FoDCS,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                 
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 0.1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.BoM.OURDF)



ECV.FoDCS.GS.BoM.BM<-mclapply(reconstruction.FoDCS,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                 
                    fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GS.BoM.BM)

###########

#Folivore Diet Categories + Group Size Categories
ECV.FoDCS.GSC.BoM.OUDF<-mclapply(reconstruction.FoDCS.gsc,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GSC.BoM.OUDF)

ECV.FoDCS.GSC.BoM.BM<-mclapply(reconstruction.FoDCS.gsc,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.GSC.BoM.BM)


######################
#Folivore Diet Categories + Social System
ECV.FoDCS.SS.BoM.OUDF<-mclapply(reconstruction.FoDCS.ss,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.SS.BoM.OUDF)

ECV.FoDCS.SS.BoM.BM<-mclapply(reconstruction.FoDCS.ss,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.SS.BoM.BM)

######################
#Folivore Diet Categories + Mating System
ECV.FoDCS.MS.BoM.OUDF<-mclapply(reconstruction.FoDCS.ms,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.MS.BoM.OUDF)

ECV.FoDCS.MS.BoM.BM<-mclapply(reconstruction.FoDCS.ms,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.MS.BoM.BM)


```

```{r}
##############
#Folivore Diet Categories + AP
ECV.FoDCS.AP.BoM.OUDF<-mclapply(reconstruction.FoDCS.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.AP.BoM.OUDF)

ECV.FoDCS.AP.BoM.BM<-mclapply(reconstruction.FoDCS.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.AP.BoM.BM)

```

```{r}
##############
#Folivore Diet Categories
ECV.FoDCS.BoM.OUDF<-mclapply(reconstruction.FoDCS,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.BoM.OUDF)

ECV.FoDCS.BoM.BM<-mclapply(reconstruction.FoDCS,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Strict ,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDCS.BoM.BM)

```

```{r}
save.image("WS from Slouch pt 1 062522.RData")

```


Original Folivore Definition Models
```{r}
#Frugivore Diet Categories + Group Size Continuous + Social System GT + Activity Period
ECV.FrDC.GS.SSGT.AP.BoM.OURDF<-mclapply(reconstruction.FrDC.ssgt.ap,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.SSGT.AP.BoM.OURDF)


ECV.FrDC.GS.SSGT.AP.BoM.BM<-mclapply(reconstruction.FrDC.ssgt.ap,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.SSGT.AP.BoM.BM)



```


```{r}
#Frugivore Diet Categories + Group Size Continuous + Social System GT
ECV.FrDC.GS.SSGT.BoM.OURDF<-mclapply(reconstruction.FrDC.ssgt,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.SSGT.BoM.OURDF)


ECV.FrDC.GS.SSGT.BoM.BM<-mclapply(reconstruction.FrDC.ssgt,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.SSGT.BoM.BM)



```


```{r}

######################
#Frugivore Diet Categories + Social System GT + AP
ECV.FrDC.SSGT.AP.BoM.OUDF<-mclapply(reconstruction.FrDC.ssgt.ap,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.SSGT.AP.BoM.OUDF)

ECV.FrDC.SSGT.AP.BoM.BM<-mclapply(reconstruction.FrDC.ssgt.ap,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.SSGT.AP.BoM.BM)


```


```{r}
######################
#Frugivore Diet Categories + Social System GT
ECV.FrDC.SSGT.BoM.OUDF<-mclapply(reconstruction.FrDC.ssgt,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.SSGT.BoM.OUDF)

ECV.FrDC.SSGT.BoM.BM<-mclapply(reconstruction.FrDC.ssgt,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.SSGT.BoM.BM)


```

Folivore Non-Folivore Diet Categories
```{r}
#Folivore Diet Categories + Group Size Continuous + Social System GT + AP
ECV.FoDC.GS.SSGT.AP.BoM.OURDF<-mclapply(reconstruction.FoDC.ssgt.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.SSGT.AP.BoM.OURDF)


ECV.FoDC.GS.SSGT.AP.BoM.BM<-mclapply(reconstruction.FoDC.ssgt.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.SSGT.AP.BoM.BM)



```

Folivore Non-Folivore Diet Categories
```{r}
#Folivore Diet Categories + Group Size Continuous + Social System GT
ECV.FoDC.GS.SSGT.BoM.OURDF<-mclapply(reconstruction.FoDC.ssgt,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.SSGT.BoM.OURDF)


ECV.FoDC.GS.SSGT.BoM.BM<-mclapply(reconstruction.FoDC.ssgt,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.SSGT.BoM.BM)



```



```{r}

######################
#Folivore Diet Categories + Social System GT + AP
ECV.FoDC.SSGT.AP.BoM.OUDF<-mclapply(reconstruction.FoDC.ssgt.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.SSGT.AP.BoM.OUDF)

ECV.FoDC.SSGT.AP.BoM.BM<-mclapply(reconstruction.FoDC.ssgt.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.SSGT.AP.BoM.BM)



```


```{r}

######################
#Folivore Diet Categories + Social System GT
ECV.FoDC.SSGT.BoM.OUDF<-mclapply(reconstruction.FoDC.ssgt,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.SSGT.BoM.OUDF)

ECV.FoDC.SSGT.BoM.BM<-mclapply(reconstruction.FoDC.ssgt,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.SSGT.BoM.BM)




```


```{r}
#Average Group Size + Social System GT + AP
ECV.GS.SSGT.AP.BoM.OURDF<-mclapply(reconstruction.ssgt.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         

                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                    
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.SSGT.AP.BoM.OURDF)

ECV.GS.SSGT.AP.BoM.BM<-mclapply(reconstruction.ssgt.ap,function(phy){
            model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.SSGT.AP.BoM.BM)






```


```{r}
#Average Group Size + Social System GT
ECV.GS.SSGT.BoM.OURDF<-mclapply(reconstruction.ssgt,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),
                    fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.SSGT.BoM.OURDF)

ECV.GS.SSGT.BoM.BM<-mclapply(reconstruction.ssgt,function(phy){
            model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),
                    fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.SSGT.BoM.BM)



```


Single Factors + AP   
```{r}
###########
#Social System GT + AP
ECV.SSGT.AP.BoM.OUDF<-mclapply(reconstruction.ssgt.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.SSGT.AP.BoM.OUDF)


ECV.SSGT.AP.BoM.BM<-mclapply(reconstruction.ssgt.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.SSGT.AP.BoM.BM)



```

Single Factors

```{r}
###########
#Social System GT
ECV.SSGT.BoM.OUDF<-mclapply(reconstruction.ssgt,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.SSGT.BoM.OUDF)


ECV.SSGT.BoM.BM<-mclapply(reconstruction.ssgt,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DGT,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.SSGT.BoM.BM)

```


###################################

## Original DeCasien Sociality Categories

Diet Categories + ...
###########################

```{r}
#Frugivore Diet Categories + Group Size Continuous + Social System + Activity Period
ECV.FrDC.GS.SS.AP.BoM.OURDF<-mclapply(reconstruction.FrDC.ss.ap,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.SS.AP.BoM.OURDF)


ECV.FrDC.GS.SS.AP.BoM.BM<-mclapply(reconstruction.FrDC.ss.ap,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.SS.AP.BoM.BM)

######################
#Frugivore Diet Categories + Group Size Continuous + Mating System + AP
ECV.FrDC.GS.MS.AP.BoM.OURDF<-mclapply(reconstruction.FrDC.ms.ap,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.MS.AP.BoM.OURDF)

ECV.FrDC.GS.MS.AP.BoM.BM<-mclapply(reconstruction.FrDC.ms.ap,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.MS.AP.BoM.BM)



```


```{r}
#Frugivore Diet Categories + Group Size Continuous + Social System
ECV.FrDC.GS.SS.BoM.OURDF<-mclapply(reconstruction.FrDC.ss,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.SS.BoM.OURDF)


ECV.FrDC.GS.SS.BoM.BM<-mclapply(reconstruction.FrDC.ss,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.SS.BoM.BM)

######################
#Frugivore Diet Categories + Group Size Continuous + Mating System
ECV.FrDC.GS.MS.BoM.OURDF<-mclapply(reconstruction.FrDC.ms,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.MS.BoM.OURDF)


ECV.FrDC.GS.MS.BoM.BM<-mclapply(reconstruction.FrDC.ms,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.MS.BoM.BM)

```


```{r}
######################
#Frugivore Diet Categories + Group Size Continuous + AP
ECV.FrDC.GS.AP.BoM.OURDF<-mclapply(reconstruction.FrDC.ap,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                              
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.AP.BoM.OURDF)



ECV.FrDC.GS.AP.BoM.BM<-mclapply(reconstruction.FrDC.ap,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                            fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.AP.BoM.BM)

###########
#Frugivore Diet Categories + Group Size Categories + AP
ECV.FrDC.GSC.AP.BoM.OUDF<-mclapply(reconstruction.FrDC.gsc.ap,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GSC.AP.BoM.OUDF)

ECV.FrDC.GSC.AP.BoM.BM<-mclapply(reconstruction.FrDC.gsc.ap,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                            fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                              
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GSC.AP.BoM.BM)


######################
#Frugivore Diet Categories + Social System + AP
ECV.FrDC.SS.AP.BoM.OUDF<-mclapply(reconstruction.FrDC.ss.ap,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.SS.AP.BoM.OUDF)

ECV.FrDC.SS.AP.BoM.BM<-mclapply(reconstruction.FrDC.ss.ap,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.SS.AP.BoM.BM)

######################
#Frugivore Diet Categories + Mating System + AP
ECV.FrDC.MS.AP.BoM.OUDF<-mclapply(reconstruction.FrDC.ms.ap,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.MS.AP.BoM.OUDF)

ECV.FrDC.MS.AP.BoM.BM<-mclapply(reconstruction.FrDC.ms.ap,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                                                            fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.MS.AP.BoM.BM)

```


```{r}
######################
#Frugivore Diet Categories + Group Size Continuous
ECV.FrDC.GS.BoM.OURDF<-mclapply(reconstruction.FrDC,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                 
                              fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.BoM.OURDF)



ECV.FrDC.GS.BoM.BM<-mclapply(reconstruction.FrDC,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                 
                              fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GS.BoM.BM)

###########
#Frugivore Diet Categories + Group Size Categories
ECV.FrDC.GSC.BoM.OUDF<-mclapply(reconstruction.FrDC.gsc,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GSC.BoM.OUDF)

ECV.FrDC.GSC.BoM.BM<-mclapply(reconstruction.FrDC.gsc,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.GSC.BoM.BM)


######################
#Frugivore Diet Categories + Social System
ECV.FrDC.SS.BoM.OUDF<-mclapply(reconstruction.FrDC.ss,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.SS.BoM.OUDF)

ECV.FrDC.SS.BoM.BM<-mclapply(reconstruction.FrDC.ss,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.SS.BoM.BM)

######################
#Frugivore Diet Categories + Mating System
ECV.FrDC.MS.BoM.OUDF<-mclapply(reconstruction.FrDC.ms,function(phy){
                      model1<-slouch.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.MS.BoM.OUDF)

ECV.FrDC.MS.BoM.BM<-mclapply(reconstruction.FrDC.ms,function(phy){
                      model1<-brown.fit(phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              anc_maps = "simmap",
                              lower = c(0.0001, 0.0001))
                      },mc.cores=num.cores)
summary(ECV.FrDC.MS.BoM.BM)

```

```{r}
save.image("WS from Slouch pt 2 062522.RData")
#load("WS from Slouch pt 2.RData")
```


Folivore Non-Folivore Diet Categories
```{r}
#Folivore Diet Categories + Group Size Continuous + Social System + AP
ECV.FoDC.GS.SS.AP.BoM.OURDF<-mclapply(reconstruction.FoDC.ss.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.SS.AP.BoM.OURDF)


ECV.FoDC.GS.SS.AP.BoM.BM<-mclapply(reconstruction.FoDC.ss.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.SS.AP.BoM.BM)

######################
#Folivore Diet Categories + Group Size Continuous + Mating System + AP

ECV.FoDC.GS.MS.AP.BoM.OURDF<-mclapply(reconstruction.FoDC.ms.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                                                                        fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.MS.AP.BoM.OURDF)


ECV.FoDC.GS.MS.AP.BoM.BM<-mclapply(reconstruction.FoDC.ms.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                                                          random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
             
                                                   fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per, BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.MS.AP.BoM.BM)

```

Folivore Non-Folivore Diet Categories
```{r}
#Folivore Diet Categories + Group Size Continuous + Social System
ECV.FoDC.GS.SS.BoM.OURDF<-mclapply(reconstruction.FoDC.ss,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.SS.BoM.OURDF)


ECV.FoDC.GS.SS.BoM.BM<-mclapply(reconstruction.FoDC.ss,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.SS.BoM.BM)

######################
#Folivore Diet Categories + Group Size Continuous + Mating System

ECV.FoDC.GS.MS.BoM.OURDF<-mclapply(reconstruction.FoDC.ms,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.MS.BoM.OURDF)


ECV.FoDC.GS.MS.BoM.BM<-mclapply(reconstruction.FoDC.ms,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.MS.BoM.BM)

```


```{r}
######################
#Folivore Diet Categories + Group Size + AP
ECV.FoDC.GS.AP.BoM.OURDF<-mclapply(reconstruction.FoDC.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          

                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 0.1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.AP.BoM.OURDF)



ECV.FoDC.GS.AP.BoM.BM<-mclapply(reconstruction.FoDC.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.AP.BoM.BM)

######################
#Folivore Diet Categories + Group Size Categories + AP
ECV.FoDC.GSC.AP.BoM.OUDF<-mclapply(reconstruction.FoDC.gsc.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GSC.AP.BoM.OUDF)

ECV.FoDC.GSC.AP.BoM.BM<-mclapply(reconstruction.FoDC.gsc.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GSC.AP.BoM.BM)

######################
###########
######################
#Folivore Diet Categories + Social System + AP
ECV.FoDC.SS.AP.BoM.OUDF<-mclapply(reconstruction.FoDC.ss.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.SS.AP.BoM.OUDF)

ECV.FoDC.SS.AP.BoM.BM<-mclapply(reconstruction.FoDC.ss.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

                                         fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.SS.AP.BoM.BM)

######################
#Folivore Diet Categories + Mating System + AP
ECV.FoDC.MS.AP.BoM.OUDF<-mclapply(reconstruction.FoDC.ms.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.MS.AP.BoM.OUDF)

ECV.FoDC.MS.AP.BoM.BM<-mclapply(reconstruction.FoDC.ms.ap,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),

fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.MS.AP.BoM.BM)


```


```{r}
######################
#Folivore Diet Categories + Group Size
ECV.FoDC.GS.BoM.OURDF<-mclapply(reconstruction.FoDC,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                 
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 0.1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.BoM.OURDF)



ECV.FoDC.GS.BoM.BM<-mclapply(reconstruction.FoDC,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                 
                    fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GS.BoM.BM)

###########

#Folivore Diet Categories + Group Size Categories
ECV.FoDC.GSC.BoM.OUDF<-mclapply(reconstruction.FoDC.gsc,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GSC.BoM.OUDF)

ECV.FoDC.GSC.BoM.BM<-mclapply(reconstruction.FoDC.gsc,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.GSC.BoM.BM)


######################
#Folivore Diet Categories + Social System
ECV.FoDC.SS.BoM.OUDF<-mclapply(reconstruction.FoDC.ss,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.SS.BoM.OUDF)

ECV.FoDC.SS.BoM.BM<-mclapply(reconstruction.FoDC.ss,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.SS.BoM.BM)

######################
#Folivore Diet Categories + Mating System
ECV.FoDC.MS.BoM.OUDF<-mclapply(reconstruction.FoDC.ms,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.MS.BoM.OUDF)

ECV.FoDC.MS.BoM.BM<-mclapply(reconstruction.FoDC.ms,function(phy){
  model1<-brown.fit(phy,
                    species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                    response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                    mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                    mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                    hillclimb = TRUE,convergence = 150,
                    anc_maps = "simmap",
                    lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.MS.BoM.BM)


```

```{r}
#Average Group Size + Social System + AP
ECV.GS.SS.AP.BoM.OURDF<-mclapply(reconstruction.ss.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         

                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                    
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.SS.AP.BoM.OURDF)

ECV.GS.SS.AP.BoM.BM<-mclapply(reconstruction.ss.ap,function(phy){
            model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                                         
                    fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.SS.AP.BoM.BM)



######################
#Average Group Size + Mating System + AP
ECV.GS.MS.AP.BoM.OURDF<-mclapply(reconstruction.ms.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                                                            random.cov = 
                              log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                               fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.MS.AP.BoM.OURDF)

ECV.GS.MS.AP.BoM.BM<-mclapply(reconstruction.ms.ap,function(phy){
            model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),                                          
                      fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.MS.AP.BoM.BM)


```

```{r}
#Average Group Size + Social System
ECV.GS.SS.BoM.OURDF<-mclapply(reconstruction.ss,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),
                    fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.SS.BoM.OURDF)

ECV.GS.SS.BoM.BM<-mclapply(reconstruction.ss,function(phy){
            model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),
                    fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.SS.BoM.BM)



######################
#Average Group Size + Mating System
ECV.GS.MS.BoM.OURDF<-mclapply(reconstruction.ms,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),
                    fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.MS.BoM.OURDF)

ECV.GS.MS.BoM.BM<-mclapply(reconstruction.ms,function(phy){
            model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),
                    fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.MS.BoM.BM)


```



#### Rerun Below
Single Factors + AP
```{r}
##############
#Frugivore Diet Categories + AP
ECV.FrDC.AP.BoM.OUDF<-mclapply(reconstruction.FrDC.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FrDC.AP.BoM.OUDF)

ECV.FrDC.AP.BoM.BM<-mclapply(reconstruction.FrDC.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FrDC.AP.BoM.BM)


```

```{r}
##############
#Folivore Diet Categories + AP
ECV.FoDC.AP.BoM.OUDF<-mclapply(reconstruction.FoDC.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.AP.BoM.OUDF)

ECV.FoDC.AP.BoM.BM<-mclapply(reconstruction.FoDC.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.AP.BoM.BM)

```

Continuous Factors + AP
```{r}
############
ECV.GS.AP.BoM.OURD<-mclapply(reconstruction.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),

                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.AP.BoM.OURD)


ECV.GS.AP.BoM.BM<-mclapply(reconstruction.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),

                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GS.AP.BoM.BM)

######################


```

```{r}
###########
#Group Size Categories + AP

ECV.GSC.AP.BoM.OUDF<-mclapply(reconstruction.gsc.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GSC.AP.BoM.OUDF)


ECV.GSC.AP.BoM.BM<-mclapply(reconstruction.gsc.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GSC.AP.BoM.BM)


```

```{r}
###########
#Social System + AP
ECV.SS.AP.BoM.OUDF<-mclapply(reconstruction.ss.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.SS.AP.BoM.OUDF)


ECV.SS.AP.BoM.BM<-mclapply(reconstruction.ss.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.SS.AP.BoM.BM)


###########
#Mating System + AP
ECV.MS.AP.BoM.OUDF<-mclapply(reconstruction.ms.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),

                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.MS.AP.BoM.OUDF)


ECV.MS.AP.BoM.BM<-mclapply(reconstruction.ms.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = as.factor(paste(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN)),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.MS.AP.BoM.BM)


```

Single Factors
```{r}
##############
#Frugivore Diet Categories
ECV.FrDC.BoM.OUDF<-mclapply(reconstruction.FrDC,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FrDC.BoM.OUDF)

ECV.FrDC.BoM.BM<-mclapply(reconstruction.FrDC,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Frug.Non.Frug.Per ,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FrDC.BoM.BM)


```

```{r}
##############
#Folivore Diet Categories
ECV.FoDC.BoM.OUDF<-mclapply(reconstruction.FoDC,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.BoM.OUDF)

ECV.FoDC.BoM.BM<-mclapply(reconstruction.FoDC,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Fol.Non.Fol.Per ,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.FoDC.BoM.BM)

```

Continuous Factors
```{r}
############
#Group Size Continuous
ECV.GS.BoM.OURD<-slouch.fit(BrBo.Diet.DC.GS.SS.AP.trdata$phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.001, max.hl*3, length.out = 50),
                     vy_values = seq(0.001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     lower = c(0.0001, 0.0001))
summary(ECV.GS.BoM.OURD)

ECV.GS.BoM.BM<-brown.fit(BrBo.Diet.DC.GS.SS.AP.trdata$phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                    random.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Combo.AGS),
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     lower = c(0.0001, 0.0001))
summary(ECV.GS.BoM.BM)

######################


```

Activity Pattern
```{r}
###########
ECV.AP.BoM.OUDF<-mclapply(reconstruction.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))},mc.cores=num.cores)
summary(ECV.AP.BoM.OUDF)


ECV.AP.BoM.OUDF<-mclapply(reconstruction.ap,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))},mc.cores=num.cores)
summary(ECV.AP.BoM.OUDF)

ECV.AP.BoM.BM<-mclapply(reconstruction.ap,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                     fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Activity.Period.DN,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.AP.BoM.BM)


```



```{r}
###########
#Group Size Categories

ECV.GSC.BoM.OUDF<-mclapply(reconstruction.gsc,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GSC.BoM.OUDF)


ECV.GSC.BoM.BM<-mclapply(reconstruction.gsc,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Cat.group.size,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.GSC.BoM.BM)


```

```{r}
###########
#Social System
ECV.SS.BoM.OUDF<-mclapply(reconstruction.ss,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.SS.BoM.OUDF)


ECV.SS.BoM.BM<-mclapply(reconstruction.ss,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$Social.System.DRclass,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.SS.BoM.BM)


###########
#Mating System
ECV.MS.BoM.OUDF<-mclapply(reconstruction.ms,function(phy){
  model1<-slouch.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,
                     direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hl_values = seq(0.0001, max.hl*3, length.out = 50),
                     vy_values = seq(0.0001, 1, length.out = 50),
                     hillclimb = FALSE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.MS.BoM.OUDF)


ECV.MS.BoM.BM<-mclapply(reconstruction.ms,function(phy){
  model1<-brown.fit(phy,
                     species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                     response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                      fixed.fact = BrBo.Diet.DC.GS.SS.AP.trdata$dat$ Mating.System,
                    direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                     mv.response = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                     mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                     hillclimb = TRUE,convergence = 150,
                     anc_maps = "simmap",
                     lower = c(0.0001, 0.0001))
},mc.cores=num.cores)
summary(ECV.MS.BoM.BM)


```




```{r}
#OU Model of Evolution
ECV.BoM.OU<-slouch.fit(phy = BrBo.Diet.DC.GS.SS.AP.trdata$phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response=BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 1, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              lower = c(0.0001, 0.0001))

summary(ECV.BoM.OU)


#BM Model of Evolution
ECV.BoM.BM<-brown.fit(phy = BrBo.Diet.DC.GS.SS.AP.trdata$phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              direct.cov = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response=BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              mv.direct.cov = BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              lower = c(0.0001, 0.0001))


summary(ECV.BoM.BM)

```

```{r}
#OU Model of Evolution
ECV.OU<-slouch.fit(phy = BrBo.Diet.DC.GS.SS.AP.trdata$phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              mv.response=BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 10, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              lower = c(0.0001, 0.0001))

summary(ECV.OU)


#BM Model of Evolution
ECV.BM<-brown.fit(phy = BrBo.Diet.DC.GS.SS.AP.trdata$phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$ECV.species.mean),
                              mv.response=BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.ECV.species,
                              hillclimb = TRUE,convergence = 150,
                              lower = c(0.0001, 0.0001))


summary(ECV.BM)

```

```{r}
#OU Model of Evolution
BoM.OU<-slouch.fit(phy = BrBo.Diet.DC.GS.SS.AP.trdata$phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response=BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hl_values = seq(0.0001, max.hl*3, length.out = 50),
                              vy_values = seq(0.0001, 10, length.out = 50),
                              hillclimb = FALSE,convergence = 150,
                              lower = c(0.0001, 0.0001))

summary(BoM.OU)


#BM Model of Evolution
BoM.BM<-brown.fit(phy = BrBo.Diet.DC.GS.SS.AP.trdata$phy,
                              species = BrBo.Diet.DC.GS.SS.AP.trdata$phy$tip.label,
                              response = log(BrBo.Diet.DC.GS.SS.AP.trdata$dat$Body.mass.species.mean),
                              mv.response=BrBo.Diet.DC.GS.SS.AP.trdata$dat$me.BoM.species,
                              hillclimb = TRUE,convergence = 150,
                              lower = c(0.0001, 0.0001))


summary(BoM.BM)

```

```{r}
save.image("WS from Slouch pt 3 062522.RData")


setDefaultCluster(cl=NULL); stopCluster(cl) 
closeAllConnections()

#load("/Volumes/GoogleDrive/My Drive/Shared with Mac Pro/Brain Size Diet + Social System/SB Revision 2/Results/SIMMAPS 061022/SIMMAPS/WS from Slouch pt 3 061022.RData")

```


## SIMMAP Reults Compilation - Discrete Models
Strict Folivore Models First

```{r}
###################
slouch.output<-lapply(ECV.FoDCS.GS.SSGT.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories Strict+Group Size+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])})
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.SSGT.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))



###################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.SSGT.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories Strict+Group Size+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.SSGT.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


##################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.SSGT.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.SSGT.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.SSGT.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.SSGT.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

```


## Original DeCasien et al. 2017 Sociality Data - social system reclassified

```{r}
#Folivore
###################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.SS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories Strict+Group Size+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.SS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

###################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.SS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories Strict+Group Size+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.SS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


#################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.MS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories Strict+Group Size+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.MS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.MS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories Strict+Group Size+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.MS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

####################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories Strict+Group Size +Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

####################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories Strict+Group Size",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))



##################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GSC.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict+Group Size Categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GSC.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size Categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GSC.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict+Group Size Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.GSC.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Group Size Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
##################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.SS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.SS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.SS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.SS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.MS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.MS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.MS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.MS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


#############################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Stricts+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Stricts+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#Single factors in addition to Body Mass
#############################
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories Strict",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDCS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories Strict",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

```

Original Folivore Definition based on % Diet
Social System Group Type
```{r}
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.SSGT.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Frug Diet Categories+Group Size+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.SSGT.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


#################

slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.SSGT.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Frug Diet Categories+Group Size+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.SSGT.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))



##################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.SSGT.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.SSGT.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


##################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.SSGT.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.SSGT.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


###################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.SSGT.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories+Group Size+Social System GT+Acivity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.SSGT.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


###################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.SSGT.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories+Group Size+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.SSGT.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


##################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.SSGT.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.SSGT.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.SSGT.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.SSGT.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.GS.SSGT.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Group Size+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.GS.SSGT.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Group Size+Social System GT+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.GS.SSGT.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Group Size+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.GS.SSGT.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Group Size+Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


#############################
slouch.output<-append(slouch.output,lapply(ECV.SSGT.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Social System GTs+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.SSGT.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Social System GTs+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.SSGT.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.SSGT.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Social System GT",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
```


## Original DeCasien et al. 2017 Sociality Data

```{r}
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.SS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Frug Diet Categories+Group Size+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.SS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


#################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.SS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Frug Diet Categories+Group Size+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.SS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


#################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.MS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Frug Diet Categories+Group Size+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.MS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.MS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Frug Diet Categories+Group Size+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.MS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

####################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Frug Diet Categories+Group Size+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

####################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Frug Diet Categories+Group Size",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


##################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GSC.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Group Size Categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GSC.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size Categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GSC.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Group Size Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.GSC.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Group Size Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.SS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.SS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


##################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.SS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.SS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.MS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.MS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


##################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.MS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.MS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#Folivore
###################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.SS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories+Group Size+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.SS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


###################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.SS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories+Group Size+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.SS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


#################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.MS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories+Group Size+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.MS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.MS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories+Group Size+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.MS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

####################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories+Group Size+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

####################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Fol Diet Categories+Group Size",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


##################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GSC.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories+Group Size Categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GSC.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size Categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GSC.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories+Group Size Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.GSC.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Group Size Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
##################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.SS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.SS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.SS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.SS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.MS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.MS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.MS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.MS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#################
#End of DIET Interaction

##################
slouch.output<-append(slouch.output,lapply(ECV.GS.SS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Group Size+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.GS.SS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Group Size+Social System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.GS.SS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Group Size+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.GS.SS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Group Size+Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.GS.MS.AP.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Group Size+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.GS.MS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Group Size+Mating System+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

##################
slouch.output<-append(slouch.output,lapply(ECV.GS.MS.BoM.OURDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.AD.DE","Group Size+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.GS.MS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Group Size+Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))


#Single Factors+AP
#############################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.GSC.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Group Size categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.GSC.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Group Size categories+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.SS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Social Systems+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.SS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Social Systems+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.MS.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Mating Systems+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.MS.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Mating Systems+Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#Single factors in addition to Body Mass
#############################
slouch.output<-append(slouch.output,lapply(ECV.FrDC.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Frug Diet Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FrDC.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Frug Diet Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.FoDC.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Fol Diet Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.FoDC.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Fol Diet Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.GSC.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Group Size Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.GSC.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Group Size Categories",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.SS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.SS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Social System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.MS.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.MS.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Mating System",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))

#############################
slouch.output<-append(slouch.output,lapply(ECV.AP.BoM.OUDF,function(slouch_data){make.slouch.table(slouch_data,"OU.FF.DE","Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))
slouch.output<-append(slouch.output,lapply(ECV.AP.BoM.BM,function(slouch_data){make.slouch.table(slouch_data,"FF.BM","Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])}))



saved.slouch.output.list<-slouch.output
```

Table testing
```{r}
model1<-saved.slouch.output.list[c(1:10)]

slouch.rep<-as.data.frame(data.table::rbindlist(model1[c(1:10)]))

sub.para<-subset(slouch.rep,Parameters==slouch.rep$Parameters[1])  
mean(sub.para$`Evol Parameter Est.`,na.rm=TRUE)
min(sub.para$`Evol Parameter Est.`,na.rm=TRUE)
max(sub.para$`Evol Parameter Est.`,na.rm=TRUE)
mean(sub.para$`Optimal Parameter Est`,na.rm=TRUE)
min(sub.para$`Optimal Parameter Est`,na.rm=TRUE)
max(sub.para$`Optimal Parameter Est`,na.rm=TRUE)
mean(slouch.rep$`t1/2 (myr)`,na.rm=TRUE)


```


```{r}
#Continuous
###########
slouch.output<-make.slouch.table(ECV.GS.BoM.OURD,"OU.AD.DE","Group Size",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1])
slouch.output<-make.slouch.table(ECV.GS.BoM.BM,"BM","Group Size",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)

#slouch.output<-make.slouch.table(ECV.AP.BoM.OURD,"OU.AD.DE","Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)
#slouch.output<-make.slouch.table(ECV.AP.BoM.BM,"BM","Activity Pattern",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)


###########
##################
slouch.output<-make.slouch.table(ECV.BoM.OU,"OU.DE","Comparison-Body Mass",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)
slouch.output<-make.slouch.table(ECV.BoM.BM,"BM","Comparison-Body Mass",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)
#######################
slouch.output<-make.slouch.table(ECV.OU,"OU.NP","ECV~1",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)
slouch.output<-make.slouch.table(ECV.BM,"BM.NP","ECV~1",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)
######################
slouch.output<-make.slouch.table(BoM.OU,"OU.NP","Body Mass~1",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)
slouch.output<-make.slouch.table(BoM.BM,"BM.NP","Body Mass~1",dim(BrBo.Diet.DC.GS.SS.AP.trdata$dat)[1],slouch.output)


#######################
#slouch.output<-rbind(data.table::rbindlist(saved.slouch.output.list),slouch.output)

slouch.table<-make_regression_table(slouch.output)

```

Save workspace
```{r}
save.image("WS from SIMMAP - All Primates - Scaled 062522.RData")
#load("/Users/markgrabowski/Documents/Academic/Research/Current Projects/Brain Size Diet + Social System - Moved to Mac Pro GD/SB Revision 2/WS/WS from SIMMAP - All Primates - Scaled 042822.RData")
```

```{r}
#load("~/Google Drive/Shared with Mac Pro/Brain Size Diet + Social System/SB Revision 1/WS/WS from Ace - All Primates - Scaled SIMMAP 042021.RData")

```

```{r}
write.csv(saved.discrete.models,"SBR2_Saved_SIMMAP_modeltesting_062522.csv")
```


Make Summary Table/AIC Table from SIMMAP Output and save
```{r}
simmap.summary.table<-make.slouch.simmap.table(saved.slouch.output.list,loops.num*sim.num)
write.csv(simmap.summary.table,"SBR2_SIMMAP_All_Primates_Scaled_Discrete_Summary_Table_062522.csv",row.names = FALSE)

simmap.AIC.table<-make.slouch.simmap.AIC.table(saved.slouch.output.list,loops.num*sim.num)
write.csv(simmap.AIC.table,"SBR2_SIMMAP_All_Primates_Scaled_Discrete_AIC_Table_062522.csv",row.names = FALSE)


```

Non-simmap functions
```{r}
write.table(slouch.output,"SBR2_SIMMAP_All_Primates_Scaled_Cont_Table_062522.csv",sep=",",row.names=FALSE)
write.table(slouch.table,"SBR2_SIMMAP_All_Primates_Scaled_Cont_AIC_Table_062522.csv",sep=",",row.names=FALSE)
```

